{
  "providers": [
    { "key": "oneDrive", "name": "OneDrive", "title": "OneDrive", "iconClass": "fa-brands fa-microsoft", "color": "#0366D6", "tags": ["storage"], "categories": ["Docs & Drive"], "hasCredentials": true,
      "credentialsForm": { "title": "OAuth Microsoft Graph", "ui": {"layout":"vertical","labelsOnTop": true}, "fields": [
        {"type":"text","key":"tenantId","label":"ID du tenant","col":{"xs":24}},
        {"type":"text","key":"clientId","label":"ID client","col":{"xs":24}},
        {"type":"text","key":"clientSecret","label":"Secret client","col":{"xs":24},"secret":true}
      ] } },
    { "key": "sharePoint", "name": "SharePoint", "title": "SharePoint", "iconClass": "fa-brands fa-microsoft", "color": "#0078D4", "tags": ["sharepoint"], "categories": ["Docs & Drive"], "hasCredentials": true }
  ],
  "nodeTemplates": [
    { "key": "onedrive_upload_file", "name": "onedriveUploadFile", "title": "Téléverser un fichier", "type": "function", "category": "OneDrive", "providerKey": "oneDrive", "output": ["Success"],
      "description": "Téléverser un fichier vers OneDrive", "args": { "title": "Téléversement", "ui": {"layout":"vertical","labelsOnTop": true}, "fields": [
        {"type":"text","key":"path","label":"Chemin","col":{"xs":24},"validators":[{"type":"required"}]},
        {"type":"textarea","key":"content","label":"Contenu (base64 ou texte)","col":{"xs":24}}
      ] } },
    { "key": "sharepoint_upload_file", "name": "sharepointUploadFile", "title": "Téléverser un fichier", "type": "function", "category": "SharePoint", "providerKey": "sharePoint", "output": ["Success"],
      "description": "Téléverser un fichier dans une bibliothèque SharePoint", "args": { "title": "Téléversement", "ui": {"layout":"vertical","labelsOnTop": true}, "fields": [
        {"type":"text","key":"siteId","label":"ID du site","col":{"xs":24}},
        {"type":"text","key":"driveId","label":"ID du drive","col":{"xs":24}},
        {"type":"text","key":"path","label":"Chemin","col":{"xs":24}},
        {"type":"textarea","key":"content","label":"Contenu","col":{"xs":24}}
      ] } },
    { "key": "sharepoint_share_link", "name": "sharepointShareLink", "title": "Créer un lien de partage", "type": "function", "category": "SharePoint", "providerKey": "sharePoint", "output": ["Success"],
      "description": "Créer un lien partageable avec permissions", "args": { "title": "Lien de partage", "ui": {"layout":"vertical","labelsOnTop": true}, "fields": [
        {"type":"text","key":"itemId","label":"ID de l’élément","col":{"xs":24},"validators":[{"type":"required"}]},
        {"type":"select","key":"type","label":"Type de lien","col":{"xs":24},"options":[{"label":"lecture","value":"view"},{"label":"édition","value":"edit"}],"default":"view"}
      ] } }
  ]
}
